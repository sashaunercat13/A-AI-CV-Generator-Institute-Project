"'Profesional Experience' As screen":
    OnVisible: |-
        =// set the button variable
        //UpdateContext({selectedItemId: Blank()});
        //Set(selectedButtonID, 0);
        
        // Initially set var to 0 so a new project is the default
        Set(varSelectedProjectID, 0);
        
        // Clear the collection
        Clear(ProjectsOfThisUser);
        
        // Create a collection of the user's projects
        Collect(ProjectsOfThisUser,
            Filter(
                'CV Generator - Project Experience',
                Email = User().Email
            )
        );
        
        //Collect(ProjectsOfThisUser, {ID: 0, 'Project Title': "New Project"});
        
        Set(varDatePicked, !IsBlank(ProjectEndDate_2.SelectedDate))

    "'Rectangle - blue top panel_2' As rectangle":
        Fill: =RGBA(39, 41, 54, 1)
        Height: =116
        Width: =1366
        ZIndex: =1

    "'Capgemini Logo_1' As image":
        Height: =60
        Image: ='Logo Blue'
        Width: =52
        X: =1288
        Y: =29
        ZIndex: =2

    "'Label - Professional Experience_2' As label":
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Height: =39
        Size: =24
        Text: ="Professional Experience"
        Width: =790
        X: =84
        Y: =37
        ZIndex: =3

    "'Icon - Circle with tick_1' As icon.CheckBadge":
        Color: =RGBA(255, 255, 255, 1)
        Icon: =Icon.CheckBadge
        X: =14
        Y: =27
        ZIndex: =4

    "'(Disabled Button) - blue background side panel_2' As button":
        Fill: =RGBA(39, 41, 54, 1)
        Height: =562
        HoverBorderColor: =
        HoverFill: =
        OnSelect: =
        PressedBorderColor: =
        Text: =""
        Width: =327
        X: =50
        Y: =145
        ZIndex: =5

    "'Label-Project Overview title_1' As label":
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Size: =18
        Text: ="Project Overview"
        Width: =257
        X: =64
        Y: =174
        ZIndex: =6

    Experience1_2 As groupContainer:
        DropShadow: =DropShadow.Regular
        Height: =562
        Width: =959
        X: =395
        Y: =145
        ZIndex: =16

        "'1ProjectDescription_2' As text":
            Default: |
                =LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Project Description')
            Height: =246
            HintText: ="Description (Max 600 characters) "
            MaxLength: =600
            Mode: =TextMode.MultiLine
            Width: =848
            X: =40
            Y: =286
            ZIndex: =1

        "'Label-Project dates_1' As label":
            Font: =Font.Verdana
            Height: =33
            Size: =20
            Text: ="When were you on this project?"
            Width: =679
            X: =34
            Y: =164
            ZIndex: =6

        "'Checkbox - Current Project_1' As checkbox":
            CheckboxSize: =30
            Font: =Font.Verdana
            OnUncheck: =true
            Size: =11
            Text: ="Are you currently on this project?"
            Width: =265
            X: =391
            Y: =80
            ZIndex: =7

        "'1ProjectTitle_2' As text":
            Default: =If(varSelectedProjectID > 0, LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Project Title'), "")
            Font: =Font.Verdana
            Height: =45
            HintText: ="Project Title"
            MaxLength: =55
            OnChange: =Set(Project1ButtonText, '1ProjectTitle_2'.Text) 
            Width: =414
            X: =34
            Y: =15
            ZIndex: =11

        "'Label&DatePicker - Start_1' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =11

            "'1ProjectStartDate_2' As datepicker":
                DefaultDate: |-
                    =If(varSelectedProjectID > 0, LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Start Date'), Today())
                    //Today()
                Font: =Font.Verdana
                Format: ="dd/mm/yyyy"
                StartOfWeek: =StartOfWeek.Monday
                X: =40
                Y: =232
                ZIndex: =2

            "'Label-StartDate_1' As label":
                Font: =Font.Verdana
                Text: ="Start date"
                X: =40
                Y: =195
                ZIndex: =4

        "'Label&DatePicker - End_1' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =11

            ProjectEndDate_2 As datepicker:
                DefaultDate: |-
                    =If(
                        'Checkbox - Current Project_1'.Value = false,
                        Blank(),
                        (If(
                            varSelectedProjectID > 0,
                            LookUp(
                                'CV Generator - Project Experience',
                                ID = varSelectedProjectID,
                                'End Date'
                            ),
                            Today()
                        ))
                    )
                    /* is this your current project? (is there is an end date?)
                    - yes (do not end Date)
                    - no  (show end date )
                    // is this a pevious project
                     - yes () */
                Font: =Font.Verdana
                Format: |
                    ="dd/mm/yyyy"
                InputTextPlaceholder: =//If(IsBlank(Self.SelectedDate), Text(Date(2001,12,31), Self.Format, Self.Language))
                OnChange: |
                    =Set(varDatePicked, !IsBlank(ProjectEndDate_2.SelectedDate))
                StartOfWeek: =StartOfWeek.Monday
                Visible: =!'Checkbox - Current Project_1'.Value
                X: =391
                Y: =232
                ZIndex: =3

            "'Label-EndDate_1' As label":
                Font: =Font.Verdana
                Text: ="End date"
                Visible: =!'Checkbox - Current Project_1'.Value
                X: =391
                Y: =195
                ZIndex: =5

        DropdownRole As dropdown:
            ContentLanguage: ="Role"
            Default: |
                =If(varSelectedProjectID > 0, LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Project Role'), "")
            Height: =45
            Items: |
                =["Product Owner",
                "Scrum Master",
                "Agile Coach",
                "Senior Business Analyst (BA)",
                "Business Analyst (BA)",
                "Product Manager",
                "Technical Lead",
                "Senior Developer",
                "Developer",
                "Junior Developer",
                "Quality Assurance (QA) Lead",
                "Quality Assurance (QA) Engineer",
                "UX/UI Lead",
                "UX/UI Designer",
                "DevOps Lead",
                "DevOps Engineer",
                "Database Administrator (DBA)",
                "Senior System Architect",
                "System Architect",
                "Release Manager",
                "Stakeholder",
                "Data Scientist",
                "Senior Cybersecurity Analyst",
                "Cybersecurity Analyst",
                "Cloud Architect",
                "Senior AI/Machine Learning Engineer",
                "AI/Machine Learning Engineer",
                "Blockchain Lead",
                "Blockchain Developer",
                "IoT Lead",
                "IoT Specialist",
                "Senior Environmental Sustainability Manager",
                "Environmental Sustainability Manager",
                "Carbon Emissions Lead Analyst",
                "Carbon Emissions Analyst",
                "Sustainable Design Lead Architect",
                "Sustainable Design Architect",
                "Senior Environmental Compliance Specialist",
                "Environmental Compliance Specialist",
                "Corporate Social Responsibility (CSR) Lead Manager",
                "Corporate Social Responsibility (CSR) Manager"]
            Visible: =false
            Width: =212
            X: =713
            Y: =16
            ZIndex: =12

        "'1ProjectManager_1' As combobox":
            Default: |-
                =If(
                    varSelectedProjectID > 0,
                    LookUp(
                        'CV Generator - Project Experience',
                        ID = varSelectedProjectID,
                        {
                            Claims: Concatenate(
                                "i:0#.f|membership|",
                                User().Email
                            ),
                            Department: "",
                            DisplayName: "",
                            Email: "Hello",
                            JobTitle: "",
                            Picture: ""
                        }
                    ),
                    {
                        Claims: "",
                        Department: "",
                        DisplayName: "",
                        Email: "",
                        JobTitle: "",
                        Picture: ""
                    }
                )
                //Today()
            DefaultSelectedItems: |-
                =/*{
                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.Client_Data",
                        Claims: 
                            User().Email
                        ,
                        DisplayName: User().FullName,
                        Email: User().Email
                    } 
                {
                
                      /*  '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.'CV Generator'",
                
                        Claims: Concatenate(
                
                            "i:0#.f|membership|",
                
                            User().Email
                
                        ),
                
                        DisplayName: User().FullName,
                
                        Email: User().Email
                
                    } 
                    */
            DisplayFields: =["DisplayName","JobTitle","Picture"]
            Font: =Font.Verdana
            Height: =33
            InputTextPlaceholder: ="Please select your manager" 
            Items: =Choices([@'CV Generator - Project Experience'].'Microsoft Profile')
            SearchFields: =["DisplayName"]
            SearchItems: =Choices('CV Generator - Project Experience'.'Microsoft Profile','1ProjectManager_1'.SearchText)
            SelectMultiple: |
                =false
            Template: =ListItemTemplate.Person
            Visible: |
                =true
            X: =34
            Y: =80
            ZIndex: =14

        ComboBoxOneClient As combobox:
            Default: =//If(varSelectedProjectID > 0, LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Project Client'), "")
            DefaultSelectedItems: |-
                =//First(ComboBoxSample)
                //If(varSelectedProjectID > 0, LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Project Client'), "")
            DisplayFields: =["Client"]
            Height: =45
            InputTextPlaceholder: ="Client"
            Items: ='CV Generator - Client/Industry'.Client
            SearchFields: =["Client"]
            SearchItems: =Search('CV Generator - Client/Industry'.Client,ComboBoxOneClient.SearchText,"Client")
            SelectMultiple: =false
            Width: =230
            X: =470
            Y: =15
            ZIndex: =15

        ComboBoxRole1 As combobox:
            Default: |
                =//If(varSelectedProjectID > 0, LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Project Role'), "")
            DisplayFields: =["Value"]
            Height: =45
            InputTextPlaceholder: ="Role"
            Items: |
                =["Product Owner",
                "Scrum Master",
                "Agile Coach",
                "Senior Business Analyst (BA)",
                "Business Analyst (BA)",
                "Product Manager",
                "Technical Lead",
                "Senior Developer",
                "Developer",
                "Junior Developer",
                "Quality Assurance (QA) Lead",
                "Quality Assurance (QA) Engineer",
                "UX/UI Lead",
                "UX/UI Designer",
                "DevOps Lead",
                "DevOps Engineer",
                "Database Administrator (DBA)",
                "Senior System Architect",
                "System Architect",
                "Release Manager",
                "Stakeholder",
                "Data Scientist",
                "Senior Cybersecurity Analyst",
                "Cybersecurity Analyst",
                "Cloud Architect",
                "Senior AI/Machine Learning Engineer",
                "AI/Machine Learning Engineer",
                "Blockchain Lead",
                "Blockchain Developer",
                "IoT Lead",
                "IoT Specialist",
                "Senior Environmental Sustainability Manager",
                "Environmental Sustainability Manager",
                "Carbon Emissions Lead Analyst",
                "Carbon Emissions Analyst",
                "Sustainable Design Lead Architect",
                "Sustainable Design Architect",
                "Senior Environmental Compliance Specialist",
                "Environmental Compliance Specialist",
                "Corporate Social Responsibility (CSR) Lead Manager",
                "Corporate Social Responsibility (CSR) Manager"]
            SearchFields: =["Value"]
            SearchItems: |-
                =Search(["Product Owner",
                "Scrum Master",
                "Agile Coach",
                "Senior Business Analyst (BA)",
                "Business Analyst (BA)",
                "Product Manager",
                "Technical Lead",
                "Senior Developer",
                "Developer",
                "Junior Developer",
                "Quality Assurance (QA) Lead",
                "Quality Assurance (QA) Engineer",
                "UX/UI Lead",
                "UX/UI Designer",
                "DevOps Lead",
                "DevOps Engineer",
                "Database Administrator (DBA)",
                "Senior System Architect",
                "System Architect",
                "Release Manager",
                "Stakeholder",
                "Data Scientist",
                "Senior Cybersecurity Analyst",
                "Cybersecurity Analyst",
                "Cloud Architect",
                "Senior AI/Machine Learning Engineer",
                "AI/Machine Learning Engineer",
                "Blockchain Lead",
                "Blockchain Developer",
                "IoT Lead",
                "IoT Specialist",
                "Senior Environmental Sustainability Manager",
                "Environmental Sustainability Manager",
                "Carbon Emissions Lead Analyst",
                "Carbon Emissions Analyst",
                "Sustainable Design Lead Architect",
                "Sustainable Design Architect",
                "Senior Environmental Compliance Specialist",
                "Environmental Compliance Specialist",
                "Corporate Social Responsibility (CSR) Lead Manager",
                "Corporate Social Responsibility (CSR) Manager"]
                ,ComboBoxRole1.SearchText,"Value")
            SelectMultiple: =false
            Width: =212
            X: =719
            Y: =16
            ZIndex: =16

    "'Button-Submit_1' As button":
        DisplayMode: |-
            =If(
                IsBlank('1ProjectTitle_2'.Text) Or 
                IsBlank(ComboBoxOneClient.SelectedItems) Or
                IsBlank(ComboBoxRole1.SelectedItems) Or 
                IsBlank('1ProjectManager_1'.SelectedItems) Or 
                IsBlank(ProjectEndDate_2.SelectedDate) Or
                IsBlank('1ProjectStartDate_2'.SelectedDate) Or
                IsBlank('1ProjectDescription_2'.Text),
            
            	DisplayMode.Disabled, DisplayMode.Edit)
        Fill: =RGBA(39, 113, 194, 1)
        OnSelect: |
            =If(
                varSelectedProjectID = 0,
                // Creating a new record because varSelectedProjectID = 0
                Patch(
                    'CV Generator - Project Experience',
                    Defaults('CV Generator - Project Experience'),// Indicates a new record
                    {
                        Email: User().Email,
                        'Project Title': '1ProjectTitle_2'.Text,
                        'Project Client': ComboBoxOneClient.Selected.Client,
                        'Project Role': ComboBoxRole1.Selected.Value,
                        'Start Date': '1ProjectStartDate_2'.SelectedDate,
                        //'End Date': varDatePicked || 'ProjectEndDate_2'.SelectedDate,
                        'Project Description': '1ProjectDescription_2'.Text,
                        'Microsoft Profile': {
                            Claims: Concatenate(
                                "i:0#.f|membership|",
                                User().Email
                            ),
                            Department: "",
                            DisplayName: User().FullName,
                            Email: User().Email,
                            JobTitle: "",
                            Picture: ""
                        }
                    }
                ),
                // Updating an existing record because varSelectedProjectID > 0
                Patch(
                    'CV Generator - Project Experience',
                    LookUp(
                        'CV Generator - Project Experience',
                        ID = varSelectedProjectID
                    ),
                    {
                        'Project Title': '1ProjectTitle_2'.Text,
                        'Project Client': ComboBoxOneClient.Selected.Client,
                        'Project Role': ComboBoxRole1.Selected.Value,
                        'Start Date': '1ProjectStartDate_2'.SelectedDate,
                        'Project Description': '1ProjectDescription_2'.Text,
                        'Microsoft Profile': {
                            Claims: Concatenate(
                                "i:0#.f|membership|",
                                User().Email
                            ),
                            Department: "",
                            DisplayName: User().FullName,
                            Email: User().Email,
                            JobTitle: "",
                            Picture: ""
                        }
                    }
                )
            );
            /*
            If (
                    !IsBlank('1ProjectEndDate_2'.SelectedDate),
                    Patch(
                        'CV Generator - Project Experience',
                        LookUp(
                            'CV Generator - Project Experience',
                            ID = varSelectedProjectID
                        ),
                        {'End Date': '1ProjectEndDate_2'.SelectedDate}
                    )
            );
            */
            // Refresh the List
            Refresh('CV Generator - Project Experience');
            // Add the new project to the list
            Clear(ProjectsOfThisUser);
            // Update the collection
            ClearCollect(
                ProjectsOfThisUser,
                Filter(
                    'CV Generator - Project Experience',
                    Email = User().Email
                )
            );
            //reset the form fields
            Reset('1ProjectTitle_2');
            Reset(ComboBoxRole1);
            //Reset('Dropdown3');
            Reset('1ProjectStartDate_2');
            Reset(ProjectEndDate_2);
            Reset('1ProjectDescription_2');
            Reset(ComboBoxOneClient);
        Text: ="Submit project"
        X: =395
        Y: =719
        ZIndex: =17

    Gallery4 As gallery.galleryVertical:
        DelayItemLoading: =true
        Height: =470
        Items: |-
            =ProjectsOfThisUser
            //Lookup('CV Generator - Project Experience', Email=User().Email);
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =50
        Width: =336
        X: =78
        Y: =237
        ZIndex: =21

        Button8 As button:
            BorderThickness: =0
            Color: =RGBA(0, 0, 0, 1)
            Fill: |-
                =//RGBA(255, 255, 255, 1);
                If(
                    ThisItem.ID = varSelectedProjectID,
                    RGBA(39, 113, 194, 1), // Red for the selected item
                    RGBA(255, 255, 255, 1) // Light gray for unselected items
                )
            Font: =Font.Verdana
            FontWeight: =FontWeight.Normal
            Height: =35
            OnSelect: |-
                =// maintain variable of this projects id
                //Set(varSelectedProjectID, ThisItem.ID);
                Set(varSelectedProjectID, ThisItem.ID);
                
                // maintain variable of this buttons id to change colour
                //UpdateContext({selectedButtonID: ThisItem.ID});
            Size: =12
            Text: =ThisItem.'Project Title'
            Width: =240
            X: =68
            Y: =15
            ZIndex: =1

        Icon8_2 As icon.Trash:
            Color: =RGBA(255, 255, 255, 1)
            Height: =35
            Icon: =Icon.Trash
            OnSelect: |-
                =Remove('CV Generator - Project Experience', ThisItem);
                
                ClearCollect(ProjectsOfThisUser,
                    Filter(
                        'CV Generator - Project Experience',
                        Email = User().Email
                    )
                );
            Width: =36
            X: =18
            Y: =15
            ZIndex: =2

    Label15 As label:
        Color: =RGBA(255, 255, 255, 1)
        Height: =36
        Size: =26
        Text: =varSelectedProjectID
        Visible: =false
        Width: =33
        X: =64
        Y: =663
        ZIndex: =22

    Button6 As button:
        Fill: =RGBA(39, 113, 194, 1)
        OnSelect: =Back()
        Text: ="Back"
        X: =14
        Y: =719
        ZIndex: =26

    Button5 As button:
        OnSelect: |-
            =// navigate to the success screen
            Navigate(Success, ScreenTransition.Fade)
        Text: ="Complete CV"
        X: =1180
        Y: =719
        ZIndex: =27

    Icon13_2 As icon.Home:
        Color: =RGBA(255, 255, 255, 1)
        Height: =60
        Icon: =Icon.Home
        OnSelect: =Navigate(Home)
        Width: =52
        X: =1221
        Y: =30
        ZIndex: =30

    Group1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =30

        Icon11 As icon.Add:
            BorderColor: =RGBA(255, 255, 255, 1)
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =0
            Height: =35
            Icon: =Icon.Add
            OnSelect: |
                =// reset the current project button
                Set(varSelectedProjectID, 0);
                
                // set this is selected button for colour
                //Set(selectedButtonID, 0);
            Width: =35
            X: =324
            Y: =174
            ZIndex: =28

        Label8 As label:
            Color: =RGBA(255, 255, 255, 1)
            OnSelect: |
                =// reset the current project button
                //Set(varSelectedProjectID, 0);
                
                // set this is selected button for colour
                //Set(selectedButtonID, 0);
            Size: =12
            Text: ="New"
            Width: =60
            X: =320
            Y: =197
            ZIndex: =29

