"'Profesional Experience' As screen":
    OnVisible: |-
        =// set the button variable
        //UpdateContext({selectedItemId: Blank()});
        //Set(selectedButtonID, 0);
        
        // Initially set var to 0 so a new project is the default
        Set(varSelectedProjectID, 0);
        
        // Clear the collection
        Clear(ProjectsOfThisUser);
        
        // Create a collection of the user's projects
        Collect(ProjectsOfThisUser,
            Filter(
                'CV Generator - Project Experience',
                Email = User().Email
            )
        );
        
        //Collect(ProjectsOfThisUser, {ID: 0, 'Project Title': "New Project"});
        
        Set(varDatePicked, !IsBlank(ProjectEndDate_2.SelectedDate))

    "'(Disabled Button) - blue background side panel_2' As button":
        Fill: =RGBA(39, 41, 54, 1)
        Height: =562
        HoverBorderColor: =
        HoverFill: =
        OnSelect: =
        PressedBorderColor: =
        Text: =""
        Width: =327
        X: =47
        Y: =144
        ZIndex: =1

    "'Label-Project Overview title_1' As label":
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Size: =18
        Text: ="Project Overview"
        Width: =257
        X: =61
        Y: =173
        ZIndex: =2

    Experience1_2 As groupContainer:
        DropShadow: =DropShadow.Regular
        Height: =562
        Width: =959
        X: =378
        Y: =144
        ZIndex: =3

    "'Button-Submit_1' As button":
        DisplayMode: |-
            =If(
                IsBlank('1ProjectTitle_2'.Text) Or 
                IsBlank(ComboBoxOneClient.SelectedItems) Or
                IsBlank(ComboBoxRole1.SelectedItems) Or 
                IsBlank('1ProjectManager_1'.SelectedItems) Or 
                IsBlank(ProjectEndDate_2.SelectedDate) Or
                IsBlank('1ProjectStartDate_2'.SelectedDate) Or
                IsBlank('1ProjectDescription_2'.Text),
            
            	DisplayMode.Disabled, DisplayMode.Edit)
        Fill: =RGBA(39, 113, 194, 1)
        OnSelect: |
            =If(
                varSelectedProjectID = 0,
                // Creating a new record because varSelectedProjectID = 0
                Patch(
                    'CV Generator - Project Experience',
                    Defaults('CV Generator - Project Experience'),// Indicates a new record
                    {
                        Email: User().Email,
                        'Project Title': '1ProjectTitle_2'.Text,
                        'Project Client': ComboBoxOneClient.Selected.Client,
                        'Project Role': ComboBoxRole1.Selected.Value,
                        'Start Date': '1ProjectStartDate_2'.SelectedDate,
                        //'End Date': varDatePicked || 'ProjectEndDate_2'.SelectedDate,
                        'Project Description': '1ProjectDescription_2'.Text,
                        'Microsoft Profile': {
                            Claims: Concatenate(
                                "i:0#.f|membership|",
                                User().Email
                            ),
                            Department: "",
                            DisplayName: User().FullName,
                            Email: User().Email,
                            JobTitle: "",
                            Picture: ""
                        }
                    }
                ),
                // Updating an existing record because varSelectedProjectID > 0
                Patch(
                    'CV Generator - Project Experience',
                    LookUp(
                        'CV Generator - Project Experience',
                        ID = varSelectedProjectID
                    ),
                    {
                        'Project Title': '1ProjectTitle_2'.Text,
                        'Project Client': ComboBoxOneClient.Selected.Client,
                        'Project Role': ComboBoxRole1.Selected.Value,
                        'Start Date': '1ProjectStartDate_2'.SelectedDate,
                        'Project Description': '1ProjectDescription_2'.Text,
                        'Microsoft Profile': {
                            Claims: Concatenate(
                                "i:0#.f|membership|",
                                User().Email
                            ),
                            Department: "",
                            DisplayName: User().FullName,
                            Email: User().Email,
                            JobTitle: "",
                            Picture: ""
                        }
                    }
                )
            );
            /*
            If (
                    !IsBlank('1ProjectEndDate_2'.SelectedDate),
                    Patch(
                        'CV Generator - Project Experience',
                        LookUp(
                            'CV Generator - Project Experience',
                            ID = varSelectedProjectID
                        ),
                        {'End Date': '1ProjectEndDate_2'.SelectedDate}
                    )
            );
            */
            // Refresh the List
            Refresh('CV Generator - Project Experience');
            // Add the new project to the list
            Clear(ProjectsOfThisUser);
            // Update the collection
            ClearCollect(
                ProjectsOfThisUser,
                Filter(
                    'CV Generator - Project Experience',
                    Email = User().Email
                )
            );
            //reset the form fields
            Reset('1ProjectTitle_2');
            Reset(ComboBoxRole1);
            //Reset('Dropdown3');
            Reset('1ProjectStartDate_2');
            Reset(ProjectEndDate_2);
            Reset('1ProjectDescription_2');
            Reset(ComboBoxOneClient);
        Text: ="Submit project"
        X: =392
        Y: =718
        ZIndex: =4

    Gallery4 As gallery.galleryVertical:
        DelayItemLoading: =true
        Height: =470
        Items: |-
            =ProjectsOfThisUser
            //Lookup('CV Generator - Project Experience', Email=User().Email);
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =50
        Width: =336
        X: =75
        Y: =236
        ZIndex: =5

    Label15 As label:
        Color: =RGBA(255, 255, 255, 1)
        Height: =36
        Size: =26
        Text: =varSelectedProjectID
        Visible: =false
        Width: =33
        X: =61
        Y: =662
        ZIndex: =6

    Button6 As button:
        Fill: =RGBA(39, 113, 194, 1)
        OnSelect: =Back()
        Text: ="Back"
        X: =11
        Y: =718
        ZIndex: =7

    Button5 As button:
        OnSelect: |-
            =// navigate to the success screen
            Navigate(Success, ScreenTransition.Fade)
        Text: ="Complete CV"
        X: =1177
        Y: =718
        ZIndex: =8

    "'Rectangle - blue top panel_2' As rectangle":
        Fill: =RGBA(39, 41, 54, 1)
        Height: =116
        Width: =1366
        ZIndex: =11

    Group1 As group:
        Height: =5
        Width: =5
        X: =26
        Y: =-105
        ZIndex: =11

    "'Capgemini Logo_1' As image":
        Height: =60
        Image: ='Logo Blue'
        Width: =52
        X: =1314
        Y: =27
        ZIndex: =12

    "'Label - Professional Experience_2' As label":
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Height: =39
        Size: =24
        Text: ="Professional Experience"
        Width: =790
        X: =124
        Y: =35
        ZIndex: =13

    "'Icon - Circle with tick_1' As icon.CheckBadge":
        Color: =RGBA(255, 255, 255, 1)
        Icon: =Icon.CheckBadge
        X: =54
        Y: =25
        ZIndex: =14

    Icon13_2 As icon.Home:
        Color: =RGBA(255, 255, 255, 1)
        Height: =60
        Icon: =Icon.Home
        OnSelect: =Navigate(Home)
        Width: =52
        X: =1261
        Y: =28
        ZIndex: =15

