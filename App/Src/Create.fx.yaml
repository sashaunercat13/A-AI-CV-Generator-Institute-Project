Create As screen:
    OnVisible: |-
        =// Setup a collection for the two hubs for each capability. This collection is used to supply the right options to the radio buttons
        ClearCollect(HubOptionSets,
        {Capability: "Data & AI Strategy", Options: ["Data Strategy & Op Model", "Data Science Consulting"]},
        {Capability: "Data & AI Innovation", Options: ["Data Science Consulting", "AI Product Innovation"]},
        {Capability: "Data & AI Factory", Options: ["Business Insights & Storytelling", "Data & AI Architecture"]},
        {Capability: "Data & AI Enablement", Options: ["Customer & Digital Analytics", "Operation & Enterprise Analytics"]}
        );

    RectangleBackgroundLeftCreate As rectangle:
        Fill: =RGBA(39, 41, 54, 1)
        Height: =768
        Width: =641
        ZIndex: =1

    ImageCapSquiggleCreate As image:
        Height: =671
        Image: ='Cap squiggle'
        Width: =616
        X: =25
        Y: =96
        ZIndex: =2

    "'Label - UserName' As label":
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Height: =42
        Size: =18
        Text: =User().FullName
        Width: =572
        X: =52
        Y: =364
        ZIndex: =3

    "'Label - UserEmail' As label":
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        Size: =14
        Text: =User().Email
        Width: =572
        X: =52
        Y: =501
        ZIndex: =4

    ImageUserProfilePicCreate As image:
        Height: =126
        Image: |
            =User().Image
        RadiusBottomLeft: |
            =60
        RadiusBottomRight: =60
        RadiusTopLeft: =60
        RadiusTopRight: =60
        Width: =127
        X: =274
        Y: =225
        ZIndex: =5

    "'Label - AboutYou' As label":
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Size: =22
        Text: ="About you"
        Width: =217
        X: =713
        Y: =367
        ZIndex: =7

    TextInputProfile As text:
        Default: =""
        EnableSpellCheck: =true
        Font: =Font.Verdana
        Height: =134
        HintText: ="Please write a short profile description about you (Max 600 characters)"
        HoverFill: =RGBA(0, 0, 0, 0)
        MaxLength: =600
        Mode: =TextMode.MultiLine
        Size: =12
        Width: =607
        X: =713
        Y: =409
        ZIndex: =8

    ButtonNextPageCreate As button:
        DisplayMode: |
            = If(
                IsBlank(DropdownCapability.Selected.Value)Or IsBlank(RadioHubs.Selected) Or IsBlank(TextInputProfile.Text) Or IsBlank(TextInputInterests.Text), 
            	DisplayMode.Disabled, DisplayMode.Edit)
        Fill: =RGBA(39, 41, 54, 1)
        OnSelect: |
            =Navigate('Skills Competancies & Qualifications');
            Patch(
                'CV Generator',
                {
                    Capability: DropdownCapability.Selected.Value,
                    Hub: RadioHubs.SelectedText.Value,
                    Photo: User().Image,
                    Email: Office365Users.MyProfile().Mail,
                    'First Name': CurrentUserFirstName,
                    'Last Name': CurrentUserLastName,
                    Grade: DropdownGradeCreate.Selected.Value,
                    Profile: TextInputProfile.Text,
                    Interests: TextInputInterests.Text,
                    'Security Clearance BPSS': BPSSchecked,
                    'Security Clearance SC': SCchecked,
                    'Microsoft Profile': {
                        Claims: Concatenate(
                            "i:0#.f|membership|",
                            User().Email
                        ),
                        Department: "",
                        DisplayName: User().FullName,
                        Email: User().Email,
                        JobTitle: "",
                        Picture: ""
                    }
                }
            );
            /* If(
                BPSSchecked,  
                Patch('CV Generator', Defaults('CV Generator'), LookUp('CV Generator', Email = User().Email),{'Security Clearance BPSS':true}), 
                Patch('CV Generator', Defaults('CV Generator'), LookUp('CV Generator', Email = User().Email),{'Security Clearance BPSS':false}));
            
             If (SCchecked,
                Patch('CV Generator', Defaults('CV Generator'), LookUp('CV Generator', Email = User().Email),{'Security Clearance SC':true}),
                Patch('CV Generator', Defaults('CV Generator'), LookUp('CV Generator', Email = User().Email),{'Security Clearance SC':false})) */
        Text: ="Next Page"
        X: =1167
        Y: =710
        ZIndex: =9

    ImageTitleTextCreate As image:
        Height: =184
        Image: ='Screenshot 2024-03-04 120003'
        Width: =415
        X: =89
        Y: =96
        ZIndex: =10

    ImageCapInventLogoCreate As image:
        Image: ='White Logo Capgemini Invent'
        Width: =572
        X: =52
        Y: =72
        ZIndex: =11

    DropdownGradeCreate As dropdown:
        ChevronBackground: =RGBA(215, 223, 240, 1)
        ChevronFill: =RGBA(0, 18, 107, 1)
        Color: =RGBA(0, 18, 107, 1)
        Fill: =RGBA(215, 223, 240, 1)
        Font: =Font.Verdana
        Items: |
            =["", "Associate Consultant","Consultant", "Senior Consultant", "Managing Director", "Director", "Vice President"]
        SelectionColor: =RGBA(0, 18, 107, 1)
        SelectionFill: =RGBA(215, 223, 240, 1)
        Size: =12
        X: =176
        Y: =604
        ZIndex: =12

    IconLogJournal As icon.LogJournal:
        Height: =143
        Icon: =Icon.LogJournal
        Width: =144
        X: =1167
        Y: =107
        ZIndex: =13

    "'Label - UserDept&UserJobTitle' As label":
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Height: =63
        Text: =Office365Users.MyProfile().Department & " - " & Office365Users.MyProfile().JobTitle
        Width: =378
        X: =149
        Y: =534
        ZIndex: =14

    "'Label -UserLocation' As label":
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Height: =63
        Text: =Office365Users.MyProfile().OfficeLocation
        Width: =378
        X: =149
        Y: =647
        ZIndex: =15

    "'Label - Interests' As label":
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Height: =28
        Size: =22
        Text: ="Interests"
        Width: =217
        X: =714
        Y: =554
        ZIndex: =16

    TextInputInterests As text:
        Default: =""
        EnableSpellCheck: =true
        Font: =Font.Verdana
        Height: =102
        HintText: =""
        HoverFill: =RGBA(0, 0, 0, 0)
        MaxLength: =250
        Mode: =TextMode.MultiLine
        Size: =12
        Width: =607
        X: =714
        Y: =592
        ZIndex: =17

    "'Label - Capability' As label":
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Text: ="Capability"
        Width: =334
        X: =710
        Y: =42
        ZIndex: =22

    RadioHubs As radio:
        BorderThickness: =2
        Items: |-
            =If(
                IsBlank(DropdownCapability.Selected),
                [],
                LookUp(HubOptionSets, Capability = DropdownCapability.Selected.Value).Options
            )
        Width: =371
        X: =710
        Y: =169
        ZIndex: =23

    "'Label - Hub' As label":
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Text: ="Hub"
        X: =711
        Y: =132
        ZIndex: =24

    "'Label - SecurityClearance' As label":
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Text: ="Security Clearance"
        Width: =377
        X: =713
        Y: =288
        ZIndex: =25

    DropdownCapability As dropdown:
        ChevronBackground: =RGBA(215, 223, 240, 1)
        ChevronFill: =RGBA(0, 18, 107, 1)
        Color: =RGBA(0, 18, 107, 1)
        Default: ="false"
        Font: =Font.Verdana
        Items: =["", "Data & AI Strategy", "Data & AI Innovation", "Data & AI Factory", "Data & AI Enablement"]
        OnChange: =
        SelectionColor: =RGBA(0, 18, 107, 1)
        SelectionFill: =RGBA(241, 244, 249, 1)
        Size: =12
        Width: =371
        X: =710
        Y: =82
        ZIndex: =27

    IconHomeCreate As icon.Home:
        Color: =RGBA(39, 41, 54, 1)
        Height: =60
        Icon: =Icon.Home
        OnSelect: =Navigate(Home)
        Tooltip: ="Take me to the homepage"
        Width: =52
        X: =1221
        Y: =30
        ZIndex: =28

    ImageCapIconCreate As image:
        Height: =60
        Image: ='Logo Blue'
        Width: =52
        X: =1288
        Y: =29
        ZIndex: =29

    "'Label - Grade' As label":
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Height: =38
        Text: ="Grade"
        Width: =76
        X: =99
        Y: =606
        ZIndex: =30

    GroupCheckbox As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =33

        CheckboxBPSS As checkbox:
            CheckboxSize: =30
            Height: =40
            OnCheck: =Set(BPSSchecked,true)
            OnUncheck: =Set(BPSSchecked,false)
            Text: ="BPSS"
            Width: =121
            X: =721
            Y: =317
            ZIndex: =18

        CheckboxSC As checkbox:
            CheckboxSize: =30
            Height: =40
            OnCheck: =Set( SCchecked, true) 
            OnUncheck: =Set(SCchecked, false) 
            Text: ="SC"
            Width: =121
            X: =851
            Y: =317
            ZIndex: =19

